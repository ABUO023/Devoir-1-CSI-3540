<!--  
    This project is for CSI 3540 - WWW and Structures

    It's written in HTML.

    I am using inline CSS with Tailwind CSS via CDN.
-->

<!doctype html>
<html lang="fr">

    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Calculator</title>

        <!-- Tailwind CSS (CDN, plain HTML) -->
        <script
            src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    </head>

    <body class="bg-neutral-950 text-neutral-100 antialiased">
        <!-- Page wrapper: forces footer to bottom -->
        <div class="h-screen max-h-screen flex flex-col overflow-hidden">
            <!-- Header -->
            <header class="border-b border-neutral-800">
                <div
                    class="max-w-5xl mx-auto px-6 h-20 flex items-center justify-between">
                    <p
                        class="font-semibold text-2xl tracking-tight">Calculator</p>

                    <span class="text-sm text-neutral-400 hidden sm:block">
                        CSI 3540
                    </span>
                </div>
            </header>

            <!-- Main content -->
            <main class="flex-1 flex items-center justify-center px-6 py-10">
                <!-- Calculator Card -->
                <section
                    class="w-full max-w-md rounded-3xl border border-neutral-800 bg-neutral-900/40 shadow-2xl shadow-black/40 overflow-hidden">
                    <!-- Display -->
                    <div class="p-6 border-b border-neutral-800">
                        <div
                            class="rounded-2xl bg-neutral-950 border border-neutral-800 px-5 py-4">
                            <p
                                class="text-xs text-neutral-500 tracking-wide">Expression</p>

                            <!-- Expression display -->
                            <p id="expression"
                                class="mt-1 text-right text-lg text-neutral-300 truncate"
                                aria-live="polite">
                                0
                            </p>

                            <div
                                class="mt-3 flex items-end justify-between gap-4">
                                <p class="text-xs text-neutral-500">Résultat</p>

                                <!-- Result display (server-side later) -->
                                <p id="result"
                                    class="text-right text-3xl sm:text-4xl font-semibold tracking-tight text-neutral-400">
                                    —
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Buttons -->
                    <div class="p-6">
                        <div class="grid grid-cols-4 gap-3">
                            <!-- Helper classes:
                   - data-value: what gets inserted into the expression
                   - data-action: special actions like clear, backspace, submit
              -->

                            <!-- Row 1 -->
                            <button type="button" data-action="clear"
                                aria-label="Effacer tout"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-sm text-neutral-300 hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                AC
                            </button>

                            <button type="button" data-action="toggle-sign"
                                aria-label="Changer le signe (géré côté serveur)"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-sm text-neutral-300 hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                ± 
                            </button>

                            <button
                            type="button"
                            disabled
                            data-value=""
                            aria-label="Pourcentage"
                            class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-sm text-neutral-300 hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700"
                            >
                            </button>


                            <button type="button" data-value=" ÷ "
                                aria-label="Division"
                                class="rounded-2xl border border-orange-500/30 bg-orange-500/10 px-4 py-4 text-lg font-semibold text-orange-300 hover:bg-orange-500/15 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-orange-500/40">
                                ÷
                            </button>

                            <!-- Row 2 -->
                            <button type="button" data-value="7" aria-label="7"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                7
                            </button>
                            <button type="button" data-value="8" aria-label="8"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                8
                            </button>
                            <button type="button" data-value="9" aria-label="9"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                9
                            </button>
                            <button type="button" data-value=" × "
                                aria-label="Multiplication"
                                class="rounded-2xl border border-orange-500/30 bg-orange-500/10 px-4 py-4 text-lg font-semibold text-orange-300 hover:bg-orange-500/15 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-orange-500/40">
                                ×
                            </button>

                            <!-- Row 3 -->
                            <button type="button" data-value="4" aria-label="4"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                4
                            </button>
                            <button type="button" data-value="5" aria-label="5"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                5
                            </button>
                            <button type="button" data-value="6" aria-label="6"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                6
                            </button>
                            <button type="button" data-value=" − "
                                aria-label="Soustraction"
                                class="rounded-2xl border border-orange-500/30 bg-orange-500/10 px-4 py-4 text-lg font-semibold text-orange-300 hover:bg-orange-500/15 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-orange-500/40">
                                −
                            </button>

                            <!-- Row 4 -->
                            <button type="button" data-value="1" aria-label="1"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                1
                            </button>
                            <button type="button" data-value="2" aria-label="2"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                2
                            </button>
                            <button type="button" data-value="3" aria-label="3"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                3
                            </button>
                            <button type="button" data-value=" + "
                                aria-label="Addition"
                                class="rounded-2xl border border-orange-500/30 bg-orange-500/10 px-4 py-4 text-lg font-semibold text-orange-300 hover:bg-orange-500/15 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-orange-500/40">
                                +
                            </button>

                            <!-- Row 5 -->
                            <button type="button" data-value="0" aria-label="0"
                                class="col-span-2 rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition text-left pl-6 focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                0
                            </button>
                            <button type="button" data-value="."
                                aria-label="Point décimal"
                                class="rounded-2xl border border-neutral-800 bg-neutral-950 px-4 py-4 text-xl hover:bg-neutral-900 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-neutral-700">
                                .
                            </button>
                            <button type="button" data-action="submit"
                                aria-label="Envoyer le calcul"
                                class="rounded-2xl border border-emerald-500/30 bg-emerald-500/10 px-4 py-4 text-lg font-semibold text-emerald-300 hover:bg-emerald-500/15 active:scale-[0.98] transition focus:outline-none focus:ring-2 focus:ring-emerald-500/40">
                                =
                            </button>
                        </div>
                    </div>
                </section>
            </main>

            <!-- Footer -->
            <!-- Footer -->
            <footer class="border-t border-neutral-800">
                <div
                    class="max-w-5xl mx-auto px-6 py-6 text-sm text-neutral-500 flex items-center justify-between">
                    <span>© 2026 — CSI3540A · Calculatrice</span>

                    <span>
                        Contact :
                        <a href="mailto:aditya@adityabaindur.dev"
                            class="hover:underline ml-1">
                            aditya@adityabaindur.dev</a></span></div>
            </footer>

        </div>

        <!-- =========================
         Calculator UI Logic (NO MATH)
         ========================= -->
        <script>
        (function () {
            const expressionEl = document.getElementById("expression");
            const resultEl = document.getElementById("result");

            // This is ONLY the UI string, not the calculation.
            let expression = "0";

            function render() {
                expressionEl.textContent = expression.length ? expression : "0";
            }

            function setResultPlaceholder(text) {
                // Still no math. This is just UI feedback.
                resultEl.textContent = text;
            }

            function clearAll() {
                expression = "0";
                setResultPlaceholder("—");
                render();
            }

            function backspace() {
                if (expression === "0") return;

                expression = expression.slice(0, -1);

                // If it becomes empty or spaces, reset.
                if (!expression.trim()) expression = "0";

                setResultPlaceholder("—");
                render();
            }

            function appendValue(value) {
                // Normalize multiple spaces
                const v = String(value);

                // If expression is just 0 and user types a number, replace.
                if (expression === "0" && /^[0-9]$/.test(v)) {
                    expression = v;
                    setResultPlaceholder("—");
                    render();
                    return;
                }

                // If expression is 0 and user types '.', make it 0.
                if (expression === "0" && v === ".") {
                    expression = "0.";
                    setResultPlaceholder("—");
                    render();
                    return;
                }

                // Basic UX: prevent duplicate operators like "5 +  ×"
                // (Still no evaluation, just string hygiene.)
                const isOperator = (s) =>
                    s === " + " || s === " − " || s === " × " || s === " ÷ ";

                const trimmed = expression.trimEnd();

                // If user presses an operator right after another operator, replace last operator.
                if (isOperator(v)) {
                    if (
                        trimmed.endsWith("+") ||
                        trimmed.endsWith("−") ||
                        trimmed.endsWith("×") ||
                        trimmed.endsWith("÷")
                    ) {
                        // Remove the last operator symbol (and spaces)
                        expression = trimmed.slice(0, -1).trimEnd();
                        expression += v;
                        setResultPlaceholder("—");
                        render();
                        return;
                    }
                }

                expression += v;
                setResultPlaceholder("—");
                render();
            }

            function toggleSign() {
                // No math: we will just wrap the whole expression for server-side.
                // Example: "12 + 3" -> "-(12 + 3)"
                // If already wrapped, unwrap.
                const trimmed = expression.trim();

                if (trimmed.startsWith("-(") && trimmed.endsWith(")")) {
                    expression = trimmed.slice(2, -1);
                } else {
                    expression = `-(${trimmed})`;
                }

                setResultPlaceholder("—");
                render();
            }

            function submitExpression() {
                // Still no math. This is where you will call CGI / Servlet later.
                // For now we just show UI feedback.
                const payload = expression.trim();

                if (!payload || payload === "0") {
                    setResultPlaceholder("—");
                    return;
                }

                // Placeholder behaviour:
                setResultPlaceholder("Envoye");

                // Example future hook:
                // fetch("/calculate", { method: "POST", body: new URLSearchParams({ expr: payload }) })
                //   .then(r => r.text())
                //   .then(html => ...)s
            }

            // Button click support (event delegation)
            document.addEventListener("click", (e) => {
                const btn = e.target.closest("button");
                if (!btn) return;

                const action = btn.getAttribute("data-action");
                const value = btn.getAttribute("data-value");

                if (action === "clear") return clearAll();
                if (action === "submit") return submitExpression();
                if (action === "toggle-sign") return toggleSign();

                if (value !== null) appendValue(value);
            });

            // Keyboard support
            document.addEventListener("keydown", (e) => {
                // Don't interfere with typical browser shortcuts
                if (e.metaKey || e.ctrlKey || e.altKey) return;

                const k = e.key;

                // Prevent page scroll on Space (we're using space in operators)
                if (k === " ") {
                    e.preventDefault();
                    return;
                }

                // Digits
                if (/^[0-9]$/.test(k)) {
                    e.preventDefault();
                    appendValue(k);
                    return;
                }

                // Decimal
                if (k === ".") {
                    e.preventDefault();
                    appendValue(".");
                    return;
                }

                // Operators (keyboard -> pretty operator)
                if (k === "+") {
                    e.preventDefault();
                    appendValue(" + ");
                    return;
                }

                if (k === "-") {
                    e.preventDefault();
                    appendValue(" − ");
                    return;
                }

                if (k === "*" || k === "x" || k === "X") {
                    e.preventDefault();
                    appendValue(" × ");
                    return;
                }

                if (k === "/") {
                    e.preventDefault();
                    appendValue(" ÷ ");
                    return;
                }

                // Actions
                if (k === "Enter") {
                    e.preventDefault();
                    submitExpression();
                    return;
                }

                if (k === "Backspace") {
                    e.preventDefault();
                    backspace();
                    return;
                }

                if (k === "Escape") {
                    e.preventDefault();
                    clearAll();
                    return;
                }
            });

            // Initial render
            render();
        })();
    </script>
    </body>

</html>